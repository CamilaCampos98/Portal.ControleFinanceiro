@page
@model Fixos
@{
	ViewData["Title"] = "Gastos Fixos";
}
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<h2><i class="bi bi-calendar-check"></i> Gastos Fixos</h2>

<form method="post">
	<div class="row g-3 mb-3">
		<div class="col-md-4">
			<label for="Pessoa" class="form-label">Pessoa</label>
			<input asp-for="Pessoa" id="Pessoa" class="form-control" />

		</div>
		<div class="col-md-6">
			<label for="TiposSelecionados" class="form-label">Tipos de Gastos Fixos</label>
			<select asp-for="TiposSelecionados" id="TiposSelecionados" class="form-select" multiple size="5">
				<option value="Condomínio">Condomínio</option>
				<option value="Conta de Luz">Conta de Luz</option>
				<option value="Financiamento Veículo">Financiamento Veículo</option>
				<option value="Financiamento Imóvel">Financiamento Imóvel</option>
				<option value="Empréstimo">Empréstimo</option>
			</select>
		</div>
	</div>
	<button type="submit" asp-page-handler="Gerar" class="btn btn-primary"><i class="bi bi-plus-circle"></i> Gerar</button>

	<button type="submit" asp-page-handler="Listar" class="btn btn-secondary"><i class="bi bi-list"></i> Listar Fixos</button>
</form>

@if (!string.IsNullOrEmpty(Model.Mensagem))
{
	<div class="alert alert-info mt-3">@Model.Mensagem</div>
}

@if (Model.FixosModel != null && Model.FixosModel.Any())
{
	<form method="post" asp-page-handler="Salvar">
		<div class="resultado">
			<h4><i class="bi bi-table"></i> Gastos Fixos Gerados</h4>
			<table class="table table-bordered table-striped" id="gridFixos">
				<thead>
					<tr>
						<th>ID</th>
						<th>Tipo</th>
						<th>Mês/Ano</th>
						<th>Vencimento</th>
						<th>Valor (R$)</th>
						<th>Pago</th>
					</tr>
				</thead>
				<tbody>
					@for (int i = 0; i < Model.FixosModel.Count; i++)
					{
						<tr>
							<td>
								@Model.FixosModel[i].Id
								<input type="hidden" name="FixosModel[@i].Id" value="@Model.FixosModel[i].Id" />
							</td>
							<td>
								@Model.FixosModel[i].Tipo
								<input type="hidden" name="FixosModel[@i].Tipo" value="@Model.FixosModel[i].Tipo" />
							</td>
							<td>
								@Model.FixosModel[i].MesAno
								<input type="hidden" name="FixosModel[@i].MesAno" value="@Model.FixosModel[i].MesAno" />
							</td>
							<td>
								@Model.FixosModel[i].Vencimento
								<input type="hidden" name="FixosModel[@i].Vencimento" value="@Model.FixosModel[i].Vencimento" />
							</td>
							<td>
								<input type="number" step="0.01" class="form-control"
									   name="FixosModel[@i].Valor"
									   value="@(Model.FixosModel[i].Valor)" />
							</td>
							<td>
								<input type="checkbox"
									   name="FixosModel[@i].Pago"
									   value="true"
									   @(Model.FixosModel[i].Pago) />
								<input type="hidden" name="FixosModel[@i].Pago" value="false" />
							</td>
						</tr>
					}
				</tbody>
			</table>

			<div class="mt-3 text-end">
				<button type="submit" class="btn btn-success">
					<i class="bi bi-save"></i> Salvar Todos
				</button>
			</div>
		</div>
	</form>

}


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

<script>
	// Inicializa o Choices no seletor
	const tiposFixos = new Choices('#TiposSelecionados', {
		removeItemButton: true,
		shouldSort: false,
	});

	// Adiciona as opções
	tiposFixos.setChoices([
		{ value: 'Condomínio', label: 'Condomínio' },
		{ value: 'Conta de Luz', label: 'Conta de Luz' },
		{ value: 'Financiamento Veículo', label: 'Financiamento Veículo' },
		{ value: 'Financiamento Imóvel', label: 'Financiamento Imóvel' },
		{ value: 'Empréstimo', label: 'Empréstimo' }
	], 'value', 'label', false);
</script>